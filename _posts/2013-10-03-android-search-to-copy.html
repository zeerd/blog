---
layout: post
title: 利用WEB搜索功能实现文字复制到剪贴板
tag: [Android]
---
有一些阅读软件――比如kindle的android版本――本身是不支持任意文字的复制功能的。这就导致有些时候想做读书笔记还需要把这段文字重新录入一遍。费时费力。
<!--break-->
<br>但是，好在kindle提供了网页搜索功能，让读者可以选择一段文字然后在google等网页中进行搜索。<br>现在，我就利用这个搜索功能将文字输出到剪贴板中。<br><br>需要准备的工作如下：<br><br>首先，在Eclipse中创建一个新的Android的工程，我将其命名为EZTools（以后还要在里面添加其他功能）。<br><br>然后，通过Project Explorer给EZTools工程添加一个新的class，命名为search2clip，然后把它弄成一个Activity，内容如下：<br><pre class="brush: java; gutter: true; first-line: 1; highlight: []; html-script: false"><br>public class search2clip extends Activity{<br>	@Override<br>	protected void onCreate(Bundle savedInstanceState) {<br>		super.onCreate(savedInstanceState);<br>		Intent intent = getIntent();<br>		String words = intent.getStringExtra(SearchManager.QUERY);<br>		//Toast.makeText(getApplicationContext(), words, Toast.LENGTH_LONG).show();<br>		<br>		ClipboardManager mClipboard = (ClipboardManager)getSystemService(CLIPBOARD_SERVICE);<br>		mClipboard.setText(words);<br>	}<br>}<br></pre><br>这个class用于将接收到的search字符串存放到剪贴板中。<br>注意：这里使用的是api-10中的函数用法。我没有更高等级版本的设备，没有实验高版本中是否可用。而google在api-11之后引入了新的剪贴板函数。<br><br>准备好了新的Activity之后，我们要把它添加到Manifest中。<br>打开EZTools工程的AndroidManifest.xml文件，选择Application标签。<br>在其中添加一个新的Application。注意，选择“Create a new element at the top level, in Application”项目。然后将其Name指定为我们刚刚创建的新的Activity（emneg.zeerd.eztools.search2clip）。<br>接下来，给这个新的application添加Intent Filter，指定其Action为android.intent.action.WEB_SEARCH，category为android.intent.category.DEFAULT。当然，如果你愿意，也可以为Intent Filter指定Label字符串。这个字符串会显示在用户选择Intent时的列表中。<br><a href="http://blog.zeerd.com/public/2013/10/CAP201310031134.jpg"><img src="http://blog.zeerd.com/public/2013/10/CAP201310031134-150x150.jpg" alt="Copy To Clip" width="150" height="150" class="alignnone size-thumbnail wp-image-616" /></a><br>最终的AndroidManifest.xml大概是下面的样子：<br><pre class="brush: xml; gutter: true; first-line: 1; highlight: []; html-script: false"><br>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br>&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;<br>    package=&quot;emneg.zeerd.eztools&quot;<br>    android:versionCode=&quot;1&quot;<br>    android:versionName=&quot;1.0&quot; &gt;<br><br>    &lt;uses-sdk<br>        android:minSdkVersion=&quot;8&quot;<br>        android:targetSdkVersion=&quot;18&quot; /&gt;<br><br>    &lt;application<br>        android:allowBackup=&quot;true&quot;<br>        android:icon=&quot;@drawable/ic_launcher&quot;<br>        android:label=&quot;@string/app_name&quot;<br>        android:theme=&quot;@style/AppTheme&quot; &gt;<br>        &lt;activity<br>            android:name=&quot;emneg.zeerd.eztools.MainActivity&quot;<br>            android:label=&quot;@string/app_name&quot; &gt;<br>            &lt;intent-filter&gt;<br>                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;<br><br>                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;<br>            &lt;/intent-filter&gt;<br>        &lt;/activity&gt;<br>        &lt;activity android:name=&quot;emneg.zeerd.eztools.search2clip&quot;&gt;<br>            &lt;intent-filter android:label=&quot;@string/search2clip&quot;&gt;<br>                &lt;action android:name=&quot;android.intent.action.WEB_SEARCH&quot;/&gt;<br>                &lt;category android:name=&quot;android.intent.category.DEFAULT&quot;/&gt;<br>            &lt;/intent-filter&gt;<br>        &lt;/activity&gt;<br>    &lt;/application&gt;<br><br>&lt;/manifest&gt;<br></pre><br><br>至此，大功告成。在Kindle中，选中一段文字，然后选择“更多选项”->“在浏览器中搜索”，然后就可以看到我们自己的应用程序了。<br><br>另外，如果不想发送到剪贴板，还可以直接发送到“分享”，直接选择其他Application进行进一步操作。只需要把前面的class替换成如下：<br><pre class="brush: java; gutter: true; first-line: 1; highlight: []; html-script: false"><br>public class Search2Share extends Activity{<br>	@Override<br>	protected void onCreate(Bundle savedInstanceState) {<br>		super.onCreate(savedInstanceState);<br>		Intent intent = getIntent();<br>		String words = intent.getStringExtra(SearchManager.QUERY);<br>		//Toast.makeText(getApplicationContext(), words, Toast.LENGTH_LONG).show();<br>		<br>		Intent intent2 = new Intent(Intent.ACTION_SEND);<br>		intent2.setType(&quot;text/plain&quot;);<br>		intent2.putExtra(Intent.EXTRA_SUBJECT, &quot;&quot;);<br>		intent2.putExtra(Intent.EXTRA_TEXT, words);<br>		startActivity(Intent.createChooser(intent2, &quot;&quot;));		<br>	}<br>}</pre><br><br>最后附上ToClip版本的完整Android工程文件。<br><a href="http://blog.zeerd.com/public/2013/10/EZTools.7z">EZTools Project</a>